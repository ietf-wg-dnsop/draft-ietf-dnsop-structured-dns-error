<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Structured Error Data for Filtered DNS</title>
<meta content="Dan Wing" name="author">
<meta content="Tirumaleswar Reddy" name="author">
<meta content="Neil Cook" name="author">
<meta content="Mohamed Boucadair" name="author">
<meta content="
       DNS filtering is widely deployed for various reasons, including
network security. However, filtered DNS responses lack structured information
for end users to understand the reason for the filtering.
Existing mechanisms to provide explanatory details to end users cause harm
especially if the blocked DNS response is for HTTPS resources. 
       This document updates RFC 8914 by signaling client support for structuring the EXTRA-TEXT field of
the Extended DNS Error to provide details on the DNS filtering. Such
details can be parsed by the client and displayed, logged, or used for
other purposes. 
    " name="description">
<meta content="xml2rfc 3.24.0" name="generator">
<meta content="Customer experience" name="keyword">
<meta content="Informed decision" name="keyword">
<meta content="transparency" name="keyword">
<meta content="enriched feedback" name="keyword">
<meta content="draft-ietf-dnsop-structured-dns-error-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.24.0
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-dnsop-structured-dns-error.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Structured DNS Error</td>
<td class="right">November 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wing, et al.</td>
<td class="center">Expires 30 May 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">DNS Operations Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-dnsop-structured-dns-error-latest</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc8914" class="eref">8914</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-11-26" class="published">26 November 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-05-30">30 May 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Wing</div>
<div class="org">Citrix</div>
</div>
<div class="author">
      <div class="author-name">T. Reddy</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">N. Cook</div>
<div class="org">Open-Xchange</div>
</div>
<div class="author">
      <div class="author-name">M. Boucadair</div>
<div class="org">Orange</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Structured Error Data for Filtered DNS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">DNS filtering is widely deployed for various reasons, including
network security. However, filtered DNS responses lack structured information
for end users to understand the reason for the filtering.
Existing mechanisms to provide explanatory details to end users cause harm
especially if the blocked DNS response is for HTTPS resources.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document updates RFC 8914 by signaling client support for structuring the EXTRA-TEXT field of
the Extended DNS Error to provide details on the DNS filtering. Such
details can be parsed by the client and displayed, logged, or used for
other purposes.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://ietf-wg-dnsop.github.io/draft-ietf-dnsop-structured-dns-error/draft-ietf-dnsop-structured-dns-error.html">https://ietf-wg-dnsop.github.io/draft-ietf-dnsop-structured-dns-error/draft-ietf-dnsop-structured-dns-error.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-dnsop-structured-dns-error/">https://datatracker.ietf.org/doc/draft-ietf-dnsop-structured-dns-error/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        dnsop Working Group mailing list (<span><a href="mailto:dnsop@ietf.org">mailto:dnsop@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/dnsop/">https://mailarchive.ietf.org/arch/browse/dnsop/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/dnsop/">https://www.ietf.org/mailman/listinfo/dnsop/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ietf-wg-dnsop/draft-ietf-dnsop-structured-dns-error">https://github.com/ietf-wg-dnsop/draft-ietf-dnsop-structured-dns-error</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 30 May 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-dns-filtering-techniques-an" class="internal xref">DNS Filtering Techniques and Their Limitations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-i-json-in-extra-text-field" class="internal xref">I-JSON in EXTRA-TEXT Field</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-protocol-operation" class="internal xref">Protocol Operation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-client-generating-request" class="internal xref">Client Generating Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-server-generating-response" class="internal xref">Server Generating Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-client-processing-response" class="internal xref">Client Processing Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-new-sub-error-codes-definit" class="internal xref">New Sub-Error Codes Definition</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-reserved" class="internal xref">Reserved</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-network-operator-policy" class="internal xref">Network Operator Policy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-dns-operator-policy" class="internal xref">DNS Operator Policy</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-extended-dns-error-code-tba" class="internal xref">Extended DNS Error Code TBA1 - Blocked by Upstream DNS Server</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-media-type-registration" class="internal xref">Media Type Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-new-registry-for-json-names" class="internal xref">New Registry for JSON Names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-new-registry-for-contact-ur" class="internal xref">New Registry for Contact URI Scheme</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-new-registry-for-dns-suberr" class="internal xref">New Registry for DNS SubError Codes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="auto internal xref">10.5</a>.  <a href="#name-new-extended-dns-error-code" class="internal xref">New Extended DNS Error Code</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-interoperation-with-rpz-ser" class="internal xref">Interoperation with RPZ Servers</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">DNS filters are deployed for a variety of reasons, e.g., endpoint
security, parental filtering, and filtering required by law
enforcement. Network-based security solutions such as firewalls and
Intrusion Prevention Systems (IPS) rely upon network traffic
inspection to implement perimeter-based security policies and operate
by filtering DNS responses. In a home network, DNS filtering is used for the
same reasons as above and additionally for parental control. Internet
Service Providers (ISPs) typically block access to some DNS domains due to a
requirement imposed by an external entity (e.g., law enforcement
agency) also performed using DNS-based content filtering.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Users of DNS services that perform filtering may wish to receive more
explanatory information about such a filtering to resolve problems with the filter
-- for example to contact the administrator to allowlist a DNS domain that
was erroneously filtered or to understand the reason a particular
domain was filtered. With that information, a user can choose
to use another network, open a trouble ticket with the DNS administrator to
resolve erroneous filtering, log the information, etc.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">For the DNS filtering mechanisms described in <a href="#existing-techniques" class="auto internal xref">Section 3</a>, the DNS
server can return extended error codes Blocked, Filtered, or
Forged Answer defined in <span><a href="https://rfc-editor.org/rfc/rfc8914#section-4" class="relref">Section 4</a> of [<a href="#RFC8914" class="cite xref">RFC8914</a>]</span>. However, these codes
only explain that filtering occurred but lack detail for the user to
diagnose erroneous filterings.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">No matter which type of response is generated (forged IP address(es),
NXDOMAIN or empty answer, even with an extended error code), the user
who triggered the DNS query has little chance to understand which
entity filtered the query, how to report a mistake in the filter, or
why the entity filtered it at all. This document describes a mechanism
to provide such detail.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">One of the other benefits of the approach described in this document is to eliminate the need to
"spoof" block pages for HTTPS resources. This is achieved since
clients implementing this approach would be able to display a
meaningful error message, and would not need to connect to such a
block page. This approach thus avoids the need to install a local root
certificate authority on those IT-managed devices.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">This document describes a format for computer-parsable data in the
EXTRA-TEXT field of <span>[<a href="#RFC8914" class="cite xref">RFC8914</a>]</span>. It updates <span><a href="https://rfc-editor.org/rfc/rfc8914#section-2" class="relref">Section 2</a> of [<a href="#RFC8914" class="cite xref">RFC8914</a>]</span> which
says the information in EXTRA-TEXT field is intended for human
consumption (not automated parsing).<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This document does not recommend DNS filtering but provides a
mechanism for better transparency to explain to the users why some DNS
queries are filtered.<a href="#section-1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document uses terms defined in DNS Terminology <span>[<a href="#RFC8499" class="cite xref">RFC8499</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">"Requestor" refers to the side that sends a request. "Responder"
refers to an authoritative, recursive resolver or other DNS component
that responds to questions.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">"Encrypted DNS" refers to any encrypted scheme to convey DNS messages,
for example, DNS-over-HTTPS <span>[<a href="#RFC8484" class="cite xref">RFC8484</a>]</span>, DNS-over-TLS <span>[<a href="#RFC7858" class="cite xref">RFC7858</a>]</span>, or
DNS-over-QUIC <span>[<a href="#RFC9250" class="cite xref">RFC9250</a>]</span>.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">The document refers to an Extended DNS Error (EDE) using its purpose, not its
INFO-CODE as per Table 3 of <span>[<a href="#RFC8914" class="cite xref">RFC8914</a>]</span>. "Forged Answer",
"Blocked", and "Filtered" are thus used to refer to "Forged Answer (4)",
"Blocked (15)", and "Filtered (17)".<a href="#section-2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="existing-techniques">
<section id="section-3">
      <h2 id="name-dns-filtering-techniques-an">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-dns-filtering-techniques-an" class="section-name selfRef">DNS Filtering Techniques and Their Limitations</a>
      </h2>
<p id="section-3-1">DNS responses can be filtered by sending, e.g., a bogus (also called
"forged") response, NXDOMAIN error, or empty answer. Also, clients can be informed that filtering has occured by sending an
Extended DNS Error code defined in <span>[<a href="#RFC8914" class="cite xref">RFC8914</a>]</span>. Each of these
methods have advantages and disadvantages that are discussed below:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-2">
<li id="section-3-2.1">
          <p id="section-3-2.1.1">The DNS response is forged to provide a list of IP addresses that
points to an HTTP(S) server alerting the end user about the reason for
blocking access to the requested domain (e.g., malware). When an
HTTP(S) enabled domain name is blocked, the network security device
(e.g., Customer Premises Equipment (CPE) or firewall) presents a block page instead of the HTTP
response from the content provider hosting that domain. If an HTTP
enabled domain name is blocked, the network security device intercepts
the HTTP request and returns a block page over HTTP. If an HTTPS
enabled domain is blocked, the block page is also served over
HTTPS. In order to return a block page over HTTPS, man in the middle
(MITM) is enabled on endpoints by generating a local root certificate
and an accompanying (local) public/private key pair. The local root
certificate is installed on the endpoint while the network security
device stores a copy of the private key. During the TLS handshake,
the on-path network security device modifies the certificate provided by the
server and (re)signs it using the private key from the local root
certificate.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1.2.1">
              <p id="section-3-2.1.2.1.1">However, this approach is ineffective when DNSSEC is deployed given that DNSSEC
ensures the integrity and authenticity of DNS responses, preventing forged DNS
responses from being accepted.<a href="#section-3-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-2.1.2.2">
              <p id="section-3-2.1.2.2.1">The HTTPS server will have access to the client's IP address and the hostname being requested.
This information will be sensitive, as it will expose the user's identity and the
domain name that a user attempted to access.<a href="#section-3-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-2.1.2.3">
              <p id="section-3-2.1.2.3.1">Configuring a local root certificate on endpoints is
not a viable option in several deployments like home networks,
schools, Small Office/Home Office (SOHO), or Small/Medium
Enterprise (SME). In these cases, the typical behavior is that
the filtered DNS response points to a server that will display
the block page. If the client is using HTTPS (via a web browser or
another application) this results in a certificate validation
error which gives no information to the end-user about the reason
for the DNS filtering.<a href="#section-3-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-2.1.2.4">
              <p id="section-3-2.1.2.4.1">Enterprise networks do not assume that all the connected devices
are managed by the IT team or Mobile Device Management (MDM)
devices, especially in the quite common Bring Your Own Device
(BYOD) scenario. In addition, the local root certificate cannot
be installed on IoT devices without a device management tool.<a href="#section-3-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-2.1.2.5">
              <p id="section-3-2.1.2.5.1">An end user does not know why the connection was prevented and,
consequently, may repeatedly try to reach the domain but with no
success. Frustrated, the end user may switch to an alternate
network that offers no DNS filtering against malware and
phishing, potentially compromising both security and
privacy. Furthermore, certificate errors train users to click
through certificate errors, which is a bad security practice. To
eliminate the need for an end user to click through certificate
errors, an end user may manually install a local root certificate
on a host device. Doing so, however, is also a bad security
practice as it creates a security vulnerability that may be
exploited by a MITM attack. When a manually installed local root
certificate expires, the user has to (again) manually install the
new local root certificate.<a href="#section-3-2.1.2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li id="section-3-2.2">
          <p id="section-3-2.2.1">The DNS response is forged to provide a NXDOMAIN response to cause
the DNS lookup to terminate in failure. However, this approach does not
work with DNSSEC. In scenarios without DNSSEC, an end user does not know why
a domain name cannot be reached and may repeatedly try to reach that domain name
but without success. Frustrated, an end user may use insecure connections
to reach the domain name, potentially compromising both security and privacy.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.3">
          <p id="section-3-2.3.1">The extended error codes Blocked and Filtered defined in
<span><a href="https://rfc-editor.org/rfc/rfc8914#section-4" class="relref">Section 4</a> of [<a href="#RFC8914" class="cite xref">RFC8914</a>]</span> can be returned by a DNS server to provide
additional information about the cause of a DNS error.<a href="#section-3-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.4">
          <p id="section-3-2.4.1">These extended error codes do not suffer from the limitations
discussed in bullets (1) and (2), but the user still does not know the
exact reason nor is aware of the exact entity blocking the
access to the domain. For example, a DNS server may block access to a
domain based on the content category such as "Malware" to protect the
endpoint from malicious software, "Phishing" to prevent the user from
revealing sensitive information to the attacker, etc. A user may need to
know the contact details of the IT/InfoSec team to raise a complaint.<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ol>
</section>
</div>
<div id="name-spec">
<section id="section-4">
      <h2 id="name-i-json-in-extra-text-field">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-i-json-in-extra-text-field" class="section-name selfRef">I-JSON in EXTRA-TEXT Field</a>
      </h2>
<p id="section-4-1">DNS servers that are compliant with this specification and have received an indication that the client also supports this specification as per <a href="#client-request" class="auto internal xref">Section 5.1</a> send data in the EXTRA-TEXT field <span>[<a href="#RFC8914" class="cite xref">RFC8914</a>]</span> encoded using the Internet JSON (I-JSON)
message format <span>[<a href="#RFC7493" class="cite xref">RFC7493</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4-2.1">
          <p id="section-4-2.1.1">Note that <span>[<a href="#RFC7493" class="cite xref">RFC7493</a>]</span> was based on <span>[<a href="#RFC7159" class="cite xref">RFC7159</a>]</span>, but <span>[<a href="#RFC7159" class="cite xref">RFC7159</a>]</span> was replaced by <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span>.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">This document defines the following JSON names:<a href="#section-4-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-4">
        <dt id="section-4-4.1">c: (contact)</dt>
        <dd style="margin-left: 1.5em" id="section-4-4.2">
          <p id="section-4-4.2.1">The contact details of the IT/InfoSec team to report mis-classified
DNS filtering. This information is important for transparency and also to ease unblocking a legitimate domain name that got blocked due to wrong classification.<a href="#section-4-4.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.3"></dt>
        <dd style="margin-left: 1.5em" id="section-4-4.4">
          <p id="section-4-4.4.1">This field is structured as an array of contact URIs, using 'tel' <span>[<a href="#RFC3966" class="cite xref">RFC3966</a>]</span> or 'sips' <span>[<a href="#RFC5630" class="cite xref">RFC5630</a>]</span> or  'mailto' <span>[<a href="#RFC3966" class="cite xref">RFC3966</a>]</span> schemes. At least one contact URI <span class="bcp14">MUST</span> be included.<a href="#section-4-4.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.5"></dt>
        <dd style="margin-left: 1.5em" id="section-4-4.6">
          <p id="section-4-4.6.1">New contact URI schemes may be added to the IANA registry following the instructions in <a href="#IANA-Contact" class="auto internal xref">Section 10.3</a>.<a href="#section-4-4.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.7"></dt>
        <dd style="margin-left: 1.5em" id="section-4-4.8">
          <p id="section-4-4.8.1">This field is mandatory.<a href="#section-4-4.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.9">j: (justification)</dt>
        <dd style="margin-left: 1.5em" id="section-4-4.10">
          <p id="section-4-4.10.1">'UTF-8'-encoded <span>[<a href="#RFC5198" class="cite xref">RFC5198</a>]</span> textual justification for this particular
DNS filtering. The field should be treated only as diagnostic
information for IT staff.<a href="#section-4-4.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.11"></dt>
        <dd style="margin-left: 1.5em" id="section-4-4.12">
          <p id="section-4-4.12.1">Whether the information provided in the "j" name is meaningful or considered as garbage data
(including empty values) is local to each IT teams. Returning garbage data
would indicate that a DNS server is misbehaving. Note also that the provided
justification is useful for cross-validation with another DNS server.<a href="#section-4-4.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.13"></dt>
        <dd style="margin-left: 1.5em" id="section-4-4.14">
          <p id="section-4-4.14.1">This field is mandatory.<a href="#section-4-4.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.15">s: (suberror)</dt>
        <dd style="margin-left: 1.5em" id="section-4-4.16">
          <p id="section-4-4.16.1">The suberror code for this particular DNS filtering.<a href="#section-4-4.16.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.17"></dt>
        <dd style="margin-left: 1.5em" id="section-4-4.18">
          <p id="section-4-4.18.1">This field is optional.<a href="#section-4-4.18.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.19">o: (organization)</dt>
        <dd style="margin-left: 1.5em" id="section-4-4.20">
          <p id="section-4-4.20.1">'UTF-8'-encoded human-friendly name of the organization that filtered this particular DNS query.<a href="#section-4-4.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.21"></dt>
        <dd style="margin-left: 1.5em" id="section-4-4.22">
          <p id="section-4-4.22.1">This field is optional.<a href="#section-4-4.22.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.23">l: (language)</dt>
        <dd style="margin-left: 1.5em" id="section-4-4.24">
          <p id="section-4-4.24.1">The "lang" field indicates the language used for the JSON-encoded "j" and "o" fields.  The value of this field <span class="bcp14">MUST</span> conform to the
language tag syntax specified in <span><a href="https://rfc-editor.org/rfc/rfc5646#section-2.1" class="relref">Section 2.1</a> of [<a href="#RFC5646" class="cite xref">RFC5646</a>]</span>.<a href="#section-4-4.24.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-4.25"></dt>
        <dd style="margin-left: 1.5em" id="section-4-4.26">
          <p id="section-4-4.26.1">This field is optional but <span class="bcp14">RECOMMENDED</span> to aid in localization.<a href="#section-4-4.26.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-5">New JSON names can be defined in the IANA registry introduced in <a href="#IANA-Names" class="auto internal xref">Section 10.2</a>. Such names <span class="bcp14">MUST</span>
consist only of lower-case ASCII characters, digits, and hyphen-minus (that
is, Unicode characters U+0061 through 007A, U+0030 through U+0039, and
U+002D). Also, these names <span class="bcp14">MUST</span> be 63 characters or shorter and it is
<span class="bcp14">RECOMMENDED</span> they be as short as possible.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">The text in the "j" and "o" names can include international
characters. The text will be in natural language, chosen by the DNS administrator
to match its expected audience.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">To reduce DNS message size the generated JSON <span class="bcp14">SHOULD</span> be as short as
possible: short domain names, concise text in the values for the "j"
and "o" names, and minified JSON (that is, without spaces or line
breaks between JSON elements).<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">The JSON data can be parsed to display to the user, logged, or
otherwise used to assist the end-user or IT staff with troubleshooting
and diagnosing the cause of the DNS filtering.<a href="#section-4-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4-9.1">
          <p id="section-4-9.1.1">An alternate design for conveying the suberror would be to define new EDE codes for these errors. However, such design is suboptimal because it requires replicating an error code for each EDE code to which the suberror applies (e.g., "Malware" suberror in <a href="#reg" class="auto internal xref">Table 3</a> would consume three EDE codes).<a href="#section-4-9.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="protocol-operation">
<section id="section-5">
      <h2 id="name-protocol-operation">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-protocol-operation" class="section-name selfRef">Protocol Operation</a>
      </h2>
<div id="client-request">
<section id="section-5.1">
        <h3 id="name-client-generating-request">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-client-generating-request" class="section-name selfRef">Client Generating Request</a>
        </h3>
<p id="section-5.1-1">When generating a DNS query the client includes the EDE option (<span><a href="https://rfc-editor.org/rfc/rfc8914#section-2" class="relref">Section 2</a> of [<a href="#RFC8914" class="cite xref">RFC8914</a>]</span>) in the OPT pseudo-RR <span>[<a href="#RFC6891" class="cite xref">RFC6891</a>]</span> to
elicit the EDE option in the DNS response. It <span class="bcp14">MUST</span> use an
OPTION-LENGTH of 2, the INFO-CODE field set to "0"
(Other Error), and an empty EXTRA-TEXT field.  This signal indicates
that the client desires that the server responds in accordance with
the present specification.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-response">
<section id="section-5.2">
        <h3 id="name-server-generating-response">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-server-generating-response" class="section-name selfRef">Server Generating Response</a>
        </h3>
<p id="section-5.2-1">When the DNS server filters its DNS response to a
query (e.g., A or AAAA record query), the DNS response <span class="bcp14">MAY</span> contain an empty answer, NXDOMAIN, or (less
ideally) forged response, as desired by the DNS
server. In addition, if the query contained the OPT pseudo-RR the DNS
server <span class="bcp14">MAY</span> return more detail in the EXTRA-TEXT field as described in
<a href="#client-processing" class="auto internal xref">Section 5.3</a>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Servers <span class="bcp14">MAY</span> decide to return small TTL values in filtered DNS
responses (e.g., 2 seconds) to handle domain category and reputation
updates. Short TTLs allow for quick adaptation to dynamic changes in domain filtering decisions,
but can result in increased query traffic. In cases where updates are less frequent,
TTL values of 30 to 60 seconds <span class="bcp14">MAY</span> provide a better balance, reducing server load while
still ensuring reasonable flexibility for updates.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">Because the DNS client signals its EDE support (<a href="#client-request" class="auto internal xref">Section 5.1</a>)
and because EDE support is signaled via a non-cached OPT resource
record (<span><a href="https://rfc-editor.org/rfc/rfc6891#section-6.2.1" class="relref">Section 6.2.1</a> of [<a href="#RFC6891" class="cite xref">RFC6891</a>]</span>) the EDE-aware DNS server can
tailor its filtered response to be most appropriate to that client's
EDE support.  If EDE support is signaled in the query as per <a href="#client-request" class="auto internal xref">Section 5.1</a>, the server <span class="bcp14">MUST NOT</span> return the "Forged Answer" extended error code because the client
can take advantage of EDE's more sophisticated error reporting (e.g.,
"Filtered", "Blocked").  Continuing to send "Forged
Answer" even to an EDE-supporting client will cause the persistence of
the drawbacks described in <a href="#existing-techniques" class="auto internal xref">Section 3</a>.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-processing">
<section id="section-5.3">
        <h3 id="name-client-processing-response">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-client-processing-response" class="section-name selfRef">Client Processing Response</a>
        </h3>
<p id="section-5.3-1">On receipt of a DNS response with an EDE option from a
DNS responder, the following ordered actions are performed on the EXTRA-TEXT
field:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.1">
            <p id="section-5.3-2.1.1">Servers which don't support this specification might use plain text
in the EXTRA-TEXT field. Requestors <span class="bcp14">SHOULD</span> properly handle
both plaintext and JSON text in the EXTRA-TEXT field. The requestor verifies that
the field contains valid JSON. If not, the requestor <span class="bcp14">MUST</span> consider
the server does not support this specification and stop processing
rest of the actions defined in this section, but may instead choose
to treat EXTRA-TEXT as per <span>[<a href="#RFC8914" class="cite xref">RFC8914</a>]</span>.<a href="#section-5.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.2">
            <p id="section-5.3-2.2.1">The response <span class="bcp14">MUST</span> be received over an encrypted DNS channel. If not,
the requestor <span class="bcp14">MUST</span> discard data in the EXTRA-TEXT field.<a href="#section-5.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.3">
            <p id="section-5.3-2.3.1">The DNS response <span class="bcp14">MUST</span> also contain an extended error code of
"Blocked by Upstream Server", "Blocked" or "Filtered" <span>[<a href="#RFC8914" class="cite xref">RFC8914</a>]</span>, otherwise
the EXTRA-TEXT field is discarded.<a href="#section-5.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.4">
            <p id="section-5.3-2.4.1">If either of the mandatory JSON names "c" and "j" are missing or
have empty values in the EXTRA-TEXT field, the entire JSON is
discarded.<a href="#section-5.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.5">
            <p id="section-5.3-2.5.1">If the "c" field contains any URI scheme not registered in the
<a href="#IANA-Contact" class="auto internal xref">Section 10.3</a> registry, it <span class="bcp14">MUST</span> be discarded.<a href="#section-5.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.6">
            <p id="section-5.3-2.6.1">If a DNS client has enabled opportunistic privacy profile (<span><a href="https://rfc-editor.org/rfc/rfc8310#section-5" class="relref">Section 5</a> of [<a href="#RFC8310" class="cite xref">RFC8310</a>]</span>) for DoT, the DNS client will either fall back to an
encrypted connection without authenticating the DNS server provided
by the local network or fall back to clear text DNS, and cannot
exchange encrypted DNS messages. Both of these fallback mechanisms
adversely impact security and privacy. If the DNS client has enabled
opportunistic privacy profile for DoT and the identity of the DNS server
cannot be verified but the connection is encrypted, the DNS client <span class="bcp14">MUST</span>
ignore the "c", "j", and "o" fields but <span class="bcp14">MAY</span> process the "s" field
and other parts of the response.<a href="#section-5.3-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.7">
            <p id="section-5.3-2.7.1">Opportunistic discovery <span>[<a href="#I-D.ietf-add-ddr" class="cite xref">I-D.ietf-add-ddr</a>]</span>, where only the IP address is
validated, the DNS client <span class="bcp14">MUST</span> ignore the "c", "j", and "o" fields
but <span class="bcp14">MAY</span> process the "s" field and other parts of the response.<a href="#section-5.3-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.8">
            <p id="section-5.3-2.8.1">If a DNS client has enabled strict privacy profile (<span><a href="https://rfc-editor.org/rfc/rfc8310#section-5" class="relref">Section 5</a> of [<a href="#RFC8310" class="cite xref">RFC8310</a>]</span>) for DoT, the DNS client requires an encrypted connection
and successful authentication of the DNS server. In doing so, this mitigates both
passive eavesdropping and client redirection (at the expense of
providing no DNS service if an encrypted, authenticated connection
is not available). If the DNS client has enabled strict privacy
profile for DoT, the DNS client <span class="bcp14">MAY</span> process the EXTRA-TEXT field of the
DNS response.<a href="#section-5.3-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.9">
            <p id="section-5.3-2.9.1">The DNS client <span class="bcp14">MUST</span> ignore any other JSON names that it does not support.<a href="#section-5.3-2.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.10">
            <p id="section-5.3-2.10.1">When a forwarder receives an EDE option, whether or not (and how) to
pass along JSON information in the EXTRA-TEXT on to their client is
implementation dependent <span>[<a href="#RFC5625" class="cite xref">RFC5625</a>]</span>. Implementations <span class="bcp14">MAY</span> choose to
not forward the JSON information, or they <span class="bcp14">MAY</span> choose to create a new
EDE option that conveys the information in the "c", "s", and "j"
fields encoded in the JSON object.<a href="#section-5.3-2.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-2.11">
            <p id="section-5.3-2.11.1">The application that triggered the DNS request may have a local policy to override the contact information
 (e.g., redirect all complaint calls to a single contact point). In such a case, the content of the
 "c" attribute can be ignored.<a href="#section-5.3-2.11.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.3-3.1">
            <p id="section-5.3-3.1.1">Note that the strict and opportunistic privacy profiles as defined in <span>[<a href="#RFC8310" class="cite xref">RFC8310</a>]</span> only apply to DoT; there has been
no such distinction made for DoH.<a href="#section-5.3-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="new-sub-error-codes-definition">
<section id="section-6">
      <h2 id="name-new-sub-error-codes-definit">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-new-sub-error-codes-definit" class="section-name selfRef">New Sub-Error Codes Definition</a>
      </h2>
<p id="section-6-1">The document defines the following new IANA-registered Sub-Error codes.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="policy-reserved">
<section id="section-6.1">
        <h3 id="name-reserved">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-reserved" class="section-name selfRef">Reserved</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-6.1-1.1">
            <p id="section-6.1-1.1.1">Number: 0<a href="#section-6.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-1.2">
            <p id="section-6.1-1.2.1">Meaning: Reserved. This sub-error code value <span class="bcp14">MUST NOT</span> be sent. If received, it has no meaning.<a href="#section-6.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-1.3">
            <p id="section-6.1-1.3.1">Applicability: This code should never be used.<a href="#section-6.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-1.4">
            <p id="section-6.1-1.4.1">Reference: This-Document<a href="#section-6.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-1.5">
            <p id="section-6.1-1.5.1">Change Controller: IETF<a href="#section-6.1-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="policy-network">
<section id="section-6.2">
        <h3 id="name-network-operator-policy">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-network-operator-policy" class="section-name selfRef">Network Operator Policy</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-6.2-1.1">
            <p id="section-6.2-1.1.1">Number: 5<a href="#section-6.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-1.2">
            <p id="section-6.2-1.2.1">Meaning: Network Operator Policy. The code indicates that the request was filtered according to a policy imposed by the operator of the local network (where local network is a relative term, e.g., it may refer to a Local Area Network or to the network of the ISP selected by the user).<a href="#section-6.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-1.3">
            <p id="section-6.2-1.3.1">Applicability: Blocked<a href="#section-6.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-1.4">
            <p id="section-6.2-1.4.1">Reference: This-Document<a href="#section-6.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-1.5">
            <p id="section-6.2-1.5.1">Change Controller: IETF<a href="#section-6.2-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="policy-dns">
<section id="section-6.3">
        <h3 id="name-dns-operator-policy">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-dns-operator-policy" class="section-name selfRef">DNS Operator Policy</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-6.3-1.1">
            <p id="section-6.3-1.1.1">Number: 6<a href="#section-6.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-1.2">
            <p id="section-6.3-1.2.1">Meaning: DNS Operator Policy. The code indicates that the request was filtered according to policy determined by the operator of the DNS server. This is different from the "Network Operator Policy" code when a third-party DNS resolver is used.<a href="#section-6.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-1.3">
            <p id="section-6.3-1.3.1">Applicability: Blocked<a href="#section-6.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-1.4">
            <p id="section-6.3-1.4.1">Reference:  This-Document<a href="#section-6.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-1.5">
            <p id="section-6.3-1.5.1">Change Controller: IETF<a href="#section-6.3-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="extended-dns-error-code-tba1-blocked-by-upstream-dns-server">
<section id="section-7">
      <h2 id="name-extended-dns-error-code-tba">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-extended-dns-error-code-tba" class="section-name selfRef">Extended DNS Error Code TBA1 - Blocked by Upstream DNS Server</a>
      </h2>
<p id="section-7-1">The DNS server (e.g., a DNS forwarder) is unable to respond to the request
because the domain is on a blocklist due to an internal security policy
imposed by an upstream DNS server. This error code
is useful in deployments where a network-provided DNS forwarder
is configured to use an external resolver that filters malicious
domains. Typically, when the DNS forwarder receives a Blocked (15) error code from the upstream DNS server, it will replace it with "Blocked by Upstream DNS Server" (TBA1) before forwarding the reply to the DNS client.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="examples">
<section id="section-8">
      <h2 id="name-examples">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="section-8-1">An example showing the nameserver at 'ns.example.net' that filtered a
DNS "A" record query for 'example.org' is provided in <a href="#example-json" class="auto internal xref">Figure 1</a>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<span id="name-json-returned-in-extra-text"></span><div id="example-json">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-8-2.1">
<pre>
{
  "c": [
    "tel:+358-555-1234567",
    "sips:bob@bobphone.example.com"
  ],
  "j": "malware present for 23 days",
  "s": 1,
  "o": "example.net Filtering Service"
  "l": "tzm",
}
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-json-returned-in-extra-text" class="selfRef">JSON Returned in EXTRA-TEXT Field of Extended DNS Error Response</a>
        </figcaption></figure>
</div>
<p id="section-8-3">In <a href="#example-json-minified" class="auto internal xref">Figure 2</a> the same content is shown with minified JSON (no
whitespace, no blank lines) with <code>'\'</code> line wrapping per <span>[<a href="#RFC8792" class="cite xref">RFC8792</a>]</span>.<a href="#section-8-3" class="pilcrow">¶</a></p>
<span id="name-minified-response"></span><div id="example-json-minified">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-8-4.1">
<pre>
=============== NOTE: '\' line wrapping per RFC 8792 ===============

{"c":["tel:+358-555-1234567","sips:bob@bobphone.example.com","https\
://ticket.example.com?d=example.org&amp;t=1650560748"],"j":"malware \
present for 23 days","s":1,"o":"example.net Filtering Service"}
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-minified-response" class="selfRef">Minified Response</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="security">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">Security considerations in <span><a href="https://rfc-editor.org/rfc/rfc8914#section-6" class="relref">Section 6</a> of [<a href="#RFC8914" class="cite xref">RFC8914</a>]</span> apply to this
document, except the guard against using EDE content to alter DNS protocol
processing. The guard is relaxed in the current specification as it mandates
encryption and recommends the use of an authenticated connection to the DNS
server, while <span>[<a href="#RFC8914" class="cite xref">RFC8914</a>]</span> assumes that EDE information is unauthenticated
and sent over clear text.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">To minimize impact of active on-path attacks on the DNS channel, the
client validates the response as described in <a href="#client-processing" class="auto internal xref">Section 5.3</a>.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">A client might choose to display the information in the "c", "j", and
"o" fields if and only if the encrypted resolver has sufficient
reputation, according to some local policy (e.g., user configuration,
administrative configuration, or a built-in list of respectable
resolvers). This limits the ability of a malicious encrypted resolver
to cause harm. For example, an end user can use the details in the "c" field to contact an attacker
to solve the problem of being unable to reach a domain. The attacker can mislead the end user to
install malware or spyware to compromise the device security posture or mislead the end user to reveal
personal data.
If the client decides not to display all of the
information in the EXTRA-TEXT field, it can be logged for diagnostics
purpose and the client can only display the resolver hostname that
blocked the domain, error description for the EDE code and the
suberror description for the "s" field to the end-user.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">When displaying the free-form text of "j" and "o", the browser <span class="bcp14">MUST NOT</span> make any of those elements into actionable (clickable) links and these
fields need to be rendered as text, not as HTML. The contact details of "c" can be made
into clickable links to provide a convenient way for users to initiate, e.g., voice calls. The client might
choose to display the contact details only when the identity of the DNS server is verified.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">An attacker might inject (or modify) the EDE EXTRA-TEXT field with a
DNS proxy or DNS forwarder that is unaware of EDE. Such a DNS proxy or
DNS forwarder will forward that attacker-controlled EDE option.  To
prevent such an attack, clients can be configured to process EDE from
explicitly configured DNS servers or utilize RESINFO
<span>[<a href="#I-D.ietf-add-resolver-info" class="cite xref">I-D.ietf-add-resolver-info</a>]</span>.<a href="#section-9-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document requests four IANA actions as described in the following subsections.<a href="#section-10-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-10-2.1">
          <p id="section-10-2.1.1">Note to the RFC Editor: Please replace RFCXXXX with the RFC number assigned to this document and "TBA1" with the value assigned by IANA.<a href="#section-10-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="media-type-registration">
<section id="section-10.1">
        <h3 id="name-media-type-registration">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-media-type-registration" class="section-name selfRef">Media Type Registration</a>
        </h3>
<p id="section-10.1-1">This document requests IANA to register the
"application/json+structured-dns-error" media type in the "Media
Types" registry <span>[<a href="#IANA-MediaTypes" class="cite xref">IANA-MediaTypes</a>]</span>. This registration follows the
procedures specified in <span>[<a href="#RFC6838" class="cite xref">RFC6838</a>]</span>:<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10.1-2">
<pre>
   Type name: application

   Subtype name: json+structured-dns-error

   Required parameters: N/A

   Optional parameters: N/A

   Encoding considerations: as defined in Section 4 of RFCXXXX.

   Security considerations: See Section 10 of RFCXXXX.

   Interoperability considerations: N/A

   Published specification: RFCXXXX

   Applications that use this media type: Section 4 of RFCXXXX.

   Fragment identifier considerations: N/A

   Additional information: N/A

   Person &amp; email address to contact for further information: IETF,
      iesg@ietf.org

   Intended usage: COMMON

   Restrictions on usage: none

   Author: See Authors' Addresses section.

   Change controller: IESG

   Provisional registration?  No
</pre><a href="#section-10.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="IANA-Names">
<section id="section-10.2">
        <h3 id="name-new-registry-for-json-names">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-new-registry-for-json-names" class="section-name selfRef">New Registry for JSON Names</a>
        </h3>
<p id="section-10.2-1">This document requests IANA to create a new registry, entitled "EXTRA-TEXT JSON Names"
under "Domain Name System (DNS) Parameters, Extended DNS Error Codes"
registry <span>[<a href="#IANA-DNS" class="cite xref">IANA-DNS</a>]</span>. The registration request for a new JSON name must include the
following fields:<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.2-2">
          <dt id="section-10.2-2.1">JSON Name:</dt>
          <dd style="margin-left: 1.5em" id="section-10.2-2.2">
            <p id="section-10.2-2.2.1">Specifies the name of an attribute that is present in the JSON data enclosed in EXTRA-TEXT field. The name must follow the guidelines in <a href="#name-spec" class="auto internal xref">Section 4</a>.<a href="#section-10.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.2-2.3">Short description:</dt>
          <dd style="margin-left: 1.5em" id="section-10.2-2.4">
            <p id="section-10.2-2.4.1">Includes a short description of the requested JSON name.<a href="#section-10.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.2-2.5">Mandatory (Y/N?):</dt>
          <dd style="margin-left: 1.5em" id="section-10.2-2.6">
            <p id="section-10.2-2.6.1">Indicates whether this attribute is mandatory or optional.<a href="#section-10.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.2-2.7">Specification:</dt>
          <dd style="margin-left: 1.5em" id="section-10.2-2.8">
            <p id="section-10.2-2.8.1">Provides a pointer to the reference document that specifies the attribute.<a href="#section-10.2-2.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.2-3">The registry is initially populated with the following values:<a href="#section-10.2-3" class="pilcrow">¶</a></p>
<span id="name-initial-json-names-registry"></span><div id="reg-names">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-initial-json-names-registry" class="selfRef">Initial JSON Names Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">JSON Name</th>
              <th class="text-left" rowspan="1" colspan="1">Full JSON Name</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Mandatory</th>
              <th class="text-center" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">c</td>
              <td class="text-left" rowspan="1" colspan="1">contact</td>
              <td class="text-left" rowspan="1" colspan="1">The contact details of the IT/InfoSec team to report mis-classified DNS filtering</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-center" rowspan="1" colspan="1">
                <a href="#name-spec" class="auto internal xref">Section 4</a> of RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">j</td>
              <td class="text-left" rowspan="1" colspan="1">justification</td>
              <td class="text-left" rowspan="1" colspan="1">UTF-8-encoded <span>[<a href="#RFC5198" class="cite xref">RFC5198</a>]</span> textual justification for a particular DNS filtering</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-center" rowspan="1" colspan="1">
                <a href="#name-spec" class="auto internal xref">Section 4</a> of RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">s</td>
              <td class="text-left" rowspan="1" colspan="1">suberror</td>
              <td class="text-left" rowspan="1" colspan="1">the suberror code for this particular DNS filtering</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-center" rowspan="1" colspan="1">
                <a href="#name-spec" class="auto internal xref">Section 4</a> of RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">o</td>
              <td class="text-left" rowspan="1" colspan="1">organization</td>
              <td class="text-left" rowspan="1" colspan="1">UTF-8-encoded human-friendly name of the organization that filtered this particular DNS query</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-center" rowspan="1" colspan="1">
                <a href="#name-spec" class="auto internal xref">Section 4</a> of RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">l</td>
              <td class="text-left" rowspan="1" colspan="1">language</td>
              <td class="text-left" rowspan="1" colspan="1">Indicates the language of the "j" and "o" fields as defined in <span>[<a href="#RFC5646" class="cite xref">RFC5646</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-center" rowspan="1" colspan="1">
                <a href="#name-spec" class="auto internal xref">Section 4</a> of RFCXXXX</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-10.2-5">New JSON names are registered via IETF Review (<span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.8" class="relref">Section 4.8</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>).<a href="#section-10.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA-Contact">
<section id="section-10.3">
        <h3 id="name-new-registry-for-contact-ur">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-new-registry-for-contact-ur" class="section-name selfRef">New Registry for Contact URI Scheme</a>
        </h3>
<p id="section-10.3-1">This document requests IANA to create a new registry, entitled "Contact URI Schemes"
under "Domain Name System (DNS) Parameters, Extended DNS Error Codes"
registry <span>[<a href="#IANA-DNS" class="cite xref">IANA-DNS</a>]</span>. The registration request for a new Contact URI scheme has to include the
following fields:<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-2.1">
            <p id="section-10.3-2.1.1">Name: URI scheme name.<a href="#section-10.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.3-2.2">
            <p id="section-10.3-2.2.1">Meaning: Provides a short description of the scheme.<a href="#section-10.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.3-2.3">
            <p id="section-10.3-2.3.1">Reference: Provides a pointer to an IETF-approved specification that defines
the URI scheme.<a href="#section-10.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.3-2.4">
            <p id="section-10.3-2.4.1">Change Controller: Indicates the person or entity, with contact information if appropriate.<a href="#section-10.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.3-3">The Contact URI scheme registry is initially be populated with the
following schemes:<a href="#section-10.3-3" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Meaning</th>
              <th class="text-center" rowspan="1" colspan="1">Reference</th>
              <th class="text-center" rowspan="1" colspan="1">Change Controller</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">sips</td>
              <td class="text-left" rowspan="1" colspan="1">SIP Call</td>
              <td class="text-center" rowspan="1" colspan="1">
                <span>[<a href="#RFC5630" class="cite xref">RFC5630</a>]</span>
</td>
              <td class="text-center" rowspan="1" colspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">tel</td>
              <td class="text-left" rowspan="1" colspan="1">Telephone Number</td>
              <td class="text-center" rowspan="1" colspan="1">
                <span>[<a href="#RFC3966" class="cite xref">RFC3966</a>]</span>
</td>
              <td class="text-center" rowspan="1" colspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">mailto</td>
              <td class="text-left" rowspan="1" colspan="1">Internet mail</td>
              <td class="text-center" rowspan="1" colspan="1">
                <span>[<a href="#RFC6068" class="cite xref">RFC6068</a>]</span>
</td>
              <td class="text-center" rowspan="1" colspan="1">IETF</td>
            </tr>
          </tbody>
        </table>
<p id="section-10.3-5">New Contact URI schemes are registered via IETF Review (<span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.8" class="relref">Section 4.8</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>).<a href="#section-10.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-registry-for-dns-suberror-codes">
<section id="section-10.4">
        <h3 id="name-new-registry-for-dns-suberr">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-new-registry-for-dns-suberr" class="section-name selfRef">New Registry for DNS SubError Codes</a>
        </h3>
<p id="section-10.4-1">This document requests IANA to create a new registry, entitled "SubError Codes"
under "Domain Name System (DNS) Parameters, Extended DNS Error Codes"
registry <span>[<a href="#IANA-DNS" class="cite xref">IANA-DNS</a>]</span>. The registration request for a new suberror codes <span class="bcp14">MUST</span> include the
following fields:<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.4-2.1">
            <p id="section-10.4-2.1.1">Number: Is the wire format suberror code (range 0-255).<a href="#section-10.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.2">
            <p id="section-10.4-2.2.1">Meaning: Provides a short description of the sub-error.<a href="#section-10.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.3">
            <p id="section-10.4-2.3.1">Applicability: Indicates which RFC8914 error codes apply to this sub-error code.<a href="#section-10.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.4">
            <p id="section-10.4-2.4.1">Reference: Provides a pointer to an IETF-approved specification that registered
the code and/or an authoritative specification that describes the
meaning of this code.<a href="#section-10.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.5">
            <p id="section-10.4-2.5.1">Change Controller: Indicates the person or entity, with contact information if appropriate.<a href="#section-10.4-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.4-3">The SubError Code registry is initially be populated with the
following suberror codes:<a href="#section-10.4-3" class="pilcrow">¶</a></p>
<span id="name-initial-suberror-code-regis"></span><div id="reg">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-initial-suberror-code-regis" class="selfRef">Initial SubError Code Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Number</th>
              <th class="text-left" rowspan="1" colspan="1">Meaning</th>
              <th class="text-left" rowspan="1" colspan="1">RFC8914 error code applicability</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-center" rowspan="1" colspan="1">Change Controller</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              <td class="text-left" rowspan="1" colspan="1">Not used</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#policy-reserved" class="auto internal xref">Section 6.1</a> of this document</td>
              <td class="text-center" rowspan="1" colspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Malware</td>
              <td class="text-left" rowspan="1" colspan="1">"Blocked", "Blocked by Upstream Server", "Filtered"</td>
              <td class="text-left" rowspan="1" colspan="1">Section 5.5 of <span>[<a href="#RFC5901" class="cite xref">RFC5901</a>]</span>
</td>
              <td class="text-center" rowspan="1" colspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Phishing</td>
              <td class="text-left" rowspan="1" colspan="1">"Blocked", "Blocked by Upstream Server", "Filtered"</td>
              <td class="text-left" rowspan="1" colspan="1">Section 5.5 of <span>[<a href="#RFC5901" class="cite xref">RFC5901</a>]</span>
</td>
              <td class="text-center" rowspan="1" colspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Spam</td>
              <td class="text-left" rowspan="1" colspan="1">"Blocked", "Blocked by Upstream Server", "Filtered"</td>
              <td class="text-left" rowspan="1" colspan="1">Page 289 of <span>[<a href="#RFC4949" class="cite xref">RFC4949</a>]</span>
</td>
              <td class="text-center" rowspan="1" colspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">Spyware</td>
              <td class="text-left" rowspan="1" colspan="1">"Blocked", "Blocked by Upstream Server", "Filtered"</td>
              <td class="text-left" rowspan="1" colspan="1">Page 291 of <span>[<a href="#RFC4949" class="cite xref">RFC4949</a>]</span>
</td>
              <td class="text-center" rowspan="1" colspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">Network operator policy</td>
              <td class="text-left" rowspan="1" colspan="1">"Blocked"</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#policy-network" class="auto internal xref">Section 6.2</a> of this document</td>
              <td class="text-center" rowspan="1" colspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">DNS operator policy</td>
              <td class="text-left" rowspan="1" colspan="1">"Blocked"</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#policy-dns" class="auto internal xref">Section 6.3</a> of this document</td>
              <td class="text-center" rowspan="1" colspan="1">IETF</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-10.4-5">New SubError Codes are registered via IETF Review (<span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.8" class="relref">Section 4.8</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>).<a href="#section-10.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-extended-dns-error-code">
<section id="section-10.5">
        <h3 id="name-new-extended-dns-error-code">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-new-extended-dns-error-code" class="section-name selfRef">New Extended DNS Error Code</a>
        </h3>
<p id="section-10.5-1">IANA is requested to assign the following Extended DNS Error code from the "Domain Name System (DNS) Parameters, Extended DNS Error Codes"
registry <span>[<a href="#IANA-DNS" class="cite xref">IANA-DNS</a>]</span>:<a href="#section-10.5-1" class="pilcrow">¶</a></p>
<span id="name-new-dns-error-code"></span><div id="reg-ede">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-new-dns-error-code" class="selfRef">New DNS Error Code</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">INFO-CODE</th>
              <th class="text-left" rowspan="1" colspan="1">Purose</th>
              <th class="text-center" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">TBA1</td>
              <td class="text-left" rowspan="1" colspan="1">Blocked by Upstream Server</td>
              <td class="text-center" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3966">[RFC3966]</dt>
        <dd>
<span class="refAuthor">Schulzrinne, H.</span>, <span class="refTitle">"The tel URI for Telephone Numbers"</span>, <span class="seriesInfo">RFC 3966</span>, <span class="seriesInfo">DOI 10.17487/RFC3966</span>, <time datetime="2004-12" class="refDate">December 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3966">https://www.rfc-editor.org/rfc/rfc3966</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[RFC4949]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4949">https://www.rfc-editor.org/rfc/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5198">[RFC5198]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span> and <span class="refAuthor">M. Padlipsky</span>, <span class="refTitle">"Unicode Format for Network Interchange"</span>, <span class="seriesInfo">RFC 5198</span>, <span class="seriesInfo">DOI 10.17487/RFC5198</span>, <time datetime="2008-03" class="refDate">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5198">https://www.rfc-editor.org/rfc/rfc5198</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5630">[RFC5630]</dt>
        <dd>
<span class="refAuthor">Audet, F.</span>, <span class="refTitle">"The Use of the SIPS URI Scheme in the Session Initiation Protocol (SIP)"</span>, <span class="seriesInfo">RFC 5630</span>, <span class="seriesInfo">DOI 10.17487/RFC5630</span>, <time datetime="2009-10" class="refDate">October 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5630">https://www.rfc-editor.org/rfc/rfc5630</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5646">[RFC5646]</dt>
        <dd>
<span class="refAuthor">Phillips, A., Ed.</span> and <span class="refAuthor">M. Davis, Ed.</span>, <span class="refTitle">"Tags for Identifying Languages"</span>, <span class="seriesInfo">BCP 47</span>, <span class="seriesInfo">RFC 5646</span>, <span class="seriesInfo">DOI 10.17487/RFC5646</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5646">https://www.rfc-editor.org/rfc/rfc5646</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5901">[RFC5901]</dt>
        <dd>
<span class="refAuthor">Cain, P.</span> and <span class="refAuthor">D. Jevans</span>, <span class="refTitle">"Extensions to the IODEF-Document Class for Reporting Phishing"</span>, <span class="seriesInfo">RFC 5901</span>, <span class="seriesInfo">DOI 10.17487/RFC5901</span>, <time datetime="2010-07" class="refDate">July 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5901">https://www.rfc-editor.org/rfc/rfc5901</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6068">[RFC6068]</dt>
        <dd>
<span class="refAuthor">Duerst, M.</span>, <span class="refAuthor">Masinter, L.</span>, and <span class="refAuthor">J. Zawinski</span>, <span class="refTitle">"The 'mailto' URI Scheme"</span>, <span class="seriesInfo">RFC 6068</span>, <span class="seriesInfo">DOI 10.17487/RFC6068</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6068">https://www.rfc-editor.org/rfc/rfc6068</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6838">https://www.rfc-editor.org/rfc/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6891">[RFC6891]</dt>
        <dd>
<span class="refAuthor">Damas, J.</span>, <span class="refAuthor">Graff, M.</span>, and <span class="refAuthor">P. Vixie</span>, <span class="refTitle">"Extension Mechanisms for DNS (EDNS(0))"</span>, <span class="seriesInfo">STD 75</span>, <span class="seriesInfo">RFC 6891</span>, <span class="seriesInfo">DOI 10.17487/RFC6891</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6891">https://www.rfc-editor.org/rfc/rfc6891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7159">[RFC7159]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">RFC 7159</span>, <span class="seriesInfo">DOI 10.17487/RFC7159</span>, <time datetime="2014-03" class="refDate">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7159">https://www.rfc-editor.org/rfc/rfc7159</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7493">[RFC7493]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The I-JSON Message Format"</span>, <span class="seriesInfo">RFC 7493</span>, <span class="seriesInfo">DOI 10.17487/RFC7493</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7493">https://www.rfc-editor.org/rfc/rfc7493</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8310">[RFC8310]</dt>
        <dd>
<span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Gillmor, D.</span>, and <span class="refAuthor">T. Reddy</span>, <span class="refTitle">"Usage Profiles for DNS over TLS and DNS over DTLS"</span>, <span class="seriesInfo">RFC 8310</span>, <span class="seriesInfo">DOI 10.17487/RFC8310</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8310">https://www.rfc-editor.org/rfc/rfc8310</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8914">[RFC8914]</dt>
      <dd>
<span class="refAuthor">Kumari, W.</span>, <span class="refAuthor">Hunt, E.</span>, <span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Hardaker, W.</span>, and <span class="refAuthor">D. Lawrence</span>, <span class="refTitle">"Extended DNS Errors"</span>, <span class="seriesInfo">RFC 8914</span>, <span class="seriesInfo">DOI 10.17487/RFC8914</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8914">https://www.rfc-editor.org/rfc/rfc8914</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-add-ddr">[I-D.ietf-add-ddr]</dt>
        <dd>
<span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Kinnear, E.</span>, <span class="refAuthor">Wood, C. A.</span>, <span class="refAuthor">McManus, P.</span>, and <span class="refAuthor">T. Jensen</span>, <span class="refTitle">"Discovery of Designated Resolvers"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-add-ddr-10</span>, <time datetime="2022-08-05" class="refDate">5 August 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-add-ddr-10">https://datatracker.ietf.org/doc/html/draft-ietf-add-ddr-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-add-resolver-info">[I-D.ietf-add-resolver-info]</dt>
        <dd>
<span class="refAuthor">Reddy.K, T.</span> and <span class="refAuthor">M. Boucadair</span>, <span class="refTitle">"DNS Resolver Information"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-add-resolver-info-13</span>, <time datetime="2024-04-26" class="refDate">26 April 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-add-resolver-info-13">https://datatracker.ietf.org/doc/html/draft-ietf-add-resolver-info-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-DNS">[IANA-DNS]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Domain Name System (DNS) Parameters, Extended DNS Error Codes"</span>, <span>&lt;<a href="https://www.iana.org/assignments/dns-parameters/dns-parameters.xhtml#extended-dns-error-codes">https://www.iana.org/assignments/dns-parameters/dns-parameters.xhtml#extended-dns-error-codes</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-MediaTypes">[IANA-MediaTypes]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Media Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/media-types">https://www.iana.org/assignments/media-types</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Impl-1">[Impl-1]</dt>
        <dd>
<span class="refTitle">"Use of DNS Errors To improve Browsing User Experience With network based malware protection"</span>, <time datetime="2023-03" class="refDate">March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/meeting/116/materials/slides-116-dnsop-dns-errors-implementation-proposal-slides-116-dnsop-update-on-dns-errors-implementation-00">https://datatracker.ietf.org/meeting/116/materials/slides-116-dnsop-dns-errors-implementation-proposal-slides-116-dnsop-update-on-dns-errors-implementation-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5625">[RFC5625]</dt>
        <dd>
<span class="refAuthor">Bellis, R.</span>, <span class="refTitle">"DNS Proxy Implementation Guidelines"</span>, <span class="seriesInfo">BCP 152</span>, <span class="seriesInfo">RFC 5625</span>, <span class="seriesInfo">DOI 10.17487/RFC5625</span>, <time datetime="2009-08" class="refDate">August 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5625">https://www.rfc-editor.org/rfc/rfc5625</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span>, <span class="refAuthor">Zhu, L.</span>, <span class="refAuthor">Heidemann, J.</span>, <span class="refAuthor">Mankin, A.</span>, <span class="refAuthor">Wessels, D.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7858">https://www.rfc-editor.org/rfc/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8484">https://www.rfc-editor.org/rfc/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8499">[RFC8499]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Sullivan, A.</span>, and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">RFC 8499</span>, <span class="seriesInfo">DOI 10.17487/RFC8499</span>, <time datetime="2019-01" class="refDate">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8499">https://www.rfc-editor.org/rfc/rfc8499</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8792">[RFC8792]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Auerswald, E.</span>, <span class="refAuthor">Farrel, A.</span>, and <span class="refAuthor">Q. Wu</span>, <span class="refTitle">"Handling Long Lines in Content of Internet-Drafts and RFCs"</span>, <span class="seriesInfo">RFC 8792</span>, <span class="seriesInfo">DOI 10.17487/RFC8792</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8792">https://www.rfc-editor.org/rfc/rfc8792</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9250">[RFC9250]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span>, <span class="refAuthor">Dickinson, S.</span>, and <span class="refAuthor">A. Mankin</span>, <span class="refTitle">"DNS over Dedicated QUIC Connections"</span>, <span class="seriesInfo">RFC 9250</span>, <span class="seriesInfo">DOI 10.17487/RFC9250</span>, <time datetime="2022-05" class="refDate">May 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9250">https://www.rfc-editor.org/rfc/rfc9250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RPZ">[RPZ]</dt>
      <dd>
<span class="refTitle">"Response Policy Zone"</span>, <span>&lt;<a href="https://dnsrpz.info">https://dnsrpz.info</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="interoperation-with-rpz-servers">
<section id="appendix-A">
      <h2 id="name-interoperation-with-rpz-ser">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-interoperation-with-rpz-ser" class="section-name selfRef">Interoperation with RPZ Servers</a>
      </h2>
<p id="appendix-A-1">This appendix provides a non-normative guidance for operation with an Response Policy Zones (RPZ) server <span>[<a href="#RPZ" class="cite xref">RPZ</a>]</span> that
indicates filtering with a NXDOMAIN response with the Recursion
Available bit cleared (RA=0). This guidance is provided to ease interoperation with RPZ.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">When a DNS client supports this specification, it includes the
EDE option in its DNS query.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">If the server does not support this specification and is performing
RPZ filtering, the server ignores the EDE option in the DNS query and
replies with NXDOMAIN and RA=0. The DNS client can continue to accept
such responses.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">If the server does support this specification and is performing RPZ
filtering, the server can use the EDE option in the query to identify
an EDE-aware client and respond appropriately (that is, by generating
a response described in <a href="#server-response" class="auto internal xref">Section 5.2</a>) as NXDOMAIN and RA=0
are not necessary when generating a response to such a client.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-status">
<section id="appendix-B">
      <h2 id="name-implementation-status">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-B-1.1">
          <p id="appendix-B-1.1.1">Note to the RFC Editor: please remove this appendix prior publication.<a href="#appendix-B-1.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-B-2">At IETF#116, Gianpaolo Scalone (Vodafone) and Ralf Weber (Akamai) presented an implementation of this specification. More details can be found at <span>[<a href="#Impl-1" class="cite xref">Impl-1</a>]</span>.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-C">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-C-1">Thanks to Vittorio Bertola, Wes Hardaker, Ben Schwartz, Erid Orth,
Viktor Dukhovni, Warren Kumari, Paul Wouters, John Levine, Bob
Harold, and Mukund Sivaraman for the comments.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">Thanks to Ralf Weber and Gianpaolo Scalone for sharing details about their implementation.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">Thanks Di Ma and Matt Brown for the DNS directorate reviews, and Joseph Salowey for the Security directorate review.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dan Wing</span></div>
<div dir="auto" class="left"><span class="org">Citrix Systems, Inc.</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:danwing@gmail.com" class="email">danwing@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tirumaleswar Reddy</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> </div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kondtir@gmail.com" class="email">kondtir@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Neil Cook</span></div>
<div dir="auto" class="left"><span class="org">Open-Xchange</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:neil.cook@noware.co.uk" class="email">neil.cook@noware.co.uk</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mohamed Boucadair</span></div>
<div dir="auto" class="left"><span class="org">Orange</span></div>
<div dir="auto" class="left"><span class="street-address">Rennes</span></div>
<div dir="auto" class="left">
<span class="postal-code">35000</span> </div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mohamed.boucadair@orange.com" class="email">mohamed.boucadair@orange.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
